<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="TrapezoidDemo.MainPage"
             xmlns:local="clr-namespace:TrapezoidDemo">

    <ContentPage.BindingContext>
        <local:MainViewModel />
    </ContentPage.BindingContext>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- Left-side input area -->
        <StackLayout Grid.Column="0" Padding="10" Spacing="10">
            <Label Text="Width:" />
            <Label Text="{Binding Width}"/>
            <Slider Minimum="0" Maximum="1000"
                    Value="{Binding Width, Mode=TwoWay}" />

            <Label Text="Height:" />
            <Label Text="{Binding Height}"/>
            <Slider Minimum="0" Maximum="1000" 
                    Value="{Binding Height, Mode=TwoWay}" />

            <Label Text="Tilt Angle:" />
            <Label Text="{Binding TiltAngle}"/>
            <Slider Minimum="0" Maximum="90"
                    Value="{Binding TiltAngle, Mode=TwoWay}" />

            <Label Text="Camera Distance:" />
            <Label Text="{Binding CameraDistance}"/>
            <Slider Minimum="0" Maximum="2000"
                    Value="{Binding CameraDistance, Mode=TwoWay}"/>

            <Label Text="AnchorY" />
            <Label Text="{Binding AnchorYValue, StringFormat='{}{0:F2}'}"/>

            <Slider Minimum="0" Maximum="1" 
                    Value="{Binding AnchorYValue, Mode=TwoWay}"/>

            <Button Text="Update" Command="{Binding UpdateCommand}" />
        </StackLayout>

        <!-- Right-side display area -->
        <AbsoluteLayout Grid.Column="1" BackgroundColor="LightGray">
            <!-- Red rectangle -->
            <AbsoluteLayout x:Name="RedRectangle"
                            WidthRequest="{Binding Width}"
                            HeightRequest="{Binding Height}"
                            BackgroundColor="Red"
                            AbsoluteLayout.LayoutBounds="0.5,0.5"
                            AbsoluteLayout.LayoutFlags="PositionProportional">
            </AbsoluteLayout>

            <!-- Green rotated rectangle -->
            <AbsoluteLayout x:Name="GreenRectangle"
                            WidthRequest="{Binding Width}"
                            HeightRequest="{Binding Height}"
                            BackgroundColor="Green"
                            RotationX="{Binding TiltAngle}"
                            AnchorY="{Binding AnchorYValue}"
                            AbsoluteLayout.LayoutBounds="0.5,0.5"
                            AbsoluteLayout.LayoutFlags="PositionProportional">
            </AbsoluteLayout>

            <!-- GraphicsView for drawing the polyline -->
            <GraphicsView x:Name="TrapezoidView"
                          Drawable="{Binding TrapezoidDrawable}"
                          WidthRequest="{Binding Width}"
                          HeightRequest="{Binding Height}"
                          AbsoluteLayout.LayoutBounds="0.5,0.5"
                          AbsoluteLayout.LayoutFlags="PositionProportional">
            </GraphicsView>
        </AbsoluteLayout>
    </Grid>
</ContentPage>
